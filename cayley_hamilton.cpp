#include<iostream>
#include "cayley_hamilton.h"

int main()
{
    int n=8;
    ctype** a=new ctype*[n];
    for(int i=0; i<n; ++i) {
        a[i]=new ctype[n];
    }

    ctype** ea=new ctype*[n];
    for(int i=0; i<n; ++i) {
        ea[i]=new ctype[n];
    }

    a[0][0]=ctype(0.813494494733650123,-0.127978420748339303);
    a[0][1]=ctype(0.0322612362764016309,0.0116546323202966991);
    a[0][2]=ctype(0.0371017324535861719,0.0666985840678917948);
    a[0][3]=ctype(-0.0260220694691860058,0.0565064013192760951);
    a[0][4]=ctype(-0.0174588404936750260,-0.0287278843525359587);
    a[0][5]=ctype(0.0358203847359044336,-0.1020649851122879126);
    a[0][6]=ctype(-0.0570969834919261468,0.0427524924684579918);
    a[0][7]=ctype(0.0387662191568104944,-0.0434881401410266179);
    a[1][0]=ctype(-0.0588564524780209462,0.0085361705064852252);
    a[1][1]=ctype(0.810430683514341794,0.029199164189984728);
    a[1][2]=ctype(0.0391335359414828308,0.0504327093501991888);
    a[1][3]=ctype(-0.0056937746568090564,0.0662314649054832293);
    a[1][4]=ctype(-0.0287885629654636982,0.0045500649428321758);
    a[1][5]=ctype(-0.0569309782754560485,-0.0373516765423924020);
    a[1][6]=ctype(0.040652928348038824,-0.139873259785476381);
    a[1][7]=ctype(0.0088318599353831983,-0.0799135626038331093);
    a[2][0]=ctype(-0.0526668577170589439,0.0464037130199993933);
    a[2][1]=ctype(-0.0236264586366088658,0.0428036201253835943);
    a[2][2]=ctype(0.815337942725190661,-0.116650693811884524);
    a[2][3]=ctype(-0.1373780956069739161,0.0245307430314038779);
    a[2][4]=ctype(-0.0382926387662550303,0.0959629422646663721);
    a[2][5]=ctype(0.0163642583301628555,0.0357741642892155903);
    a[2][6]=ctype(-0.0161608669791660359,0.0727135441659692538);
    a[2][7]=ctype(-0.0048114680901568499,0.0815106501027431446);
    a[3][0]=ctype(0.0624945449280189374,0.0050524904830161736);
    a[3][1]=ctype(0.0287355875740266264,0.0257986237612141758);
    a[3][2]=ctype(0.119797941320204707,0.086760901771687213);
    a[3][3]=ctype(0.817816692108943676,0.121379102789683048);
    a[3][4]=ctype(-0.0248339124723779387,0.0912346046808227181);
    a[3][5]=ctype(0.0655169236984795414,-0.0543013926127099760);
    a[3][6]=ctype(0.1049831832526399922,0.0630719749627622704);
    a[3][7]=ctype(0.073891967189375982,0.136031615132704310);
    a[4][0]=ctype(0.0050858037169416579,-0.0150180386817605789);
    a[4][1]=ctype(0.0101090619525311715,-0.0181591003021518921);
    a[4][2]=ctype(0.0580258423451176512,0.0813741184816283238);
    a[4][3]=ctype(-0.0329945421119793168,0.1008308709598752140);
    a[4][4]=ctype(0.855897940466625365,0.082907667260996906);
    a[4][5]=ctype(0.0468769853328158386,0.0205050613095213346);
    a[4][6]=ctype(-0.032645900570692099,-0.141317899451328912);
    a[4][7]=ctype(-0.0518115408780987715,-0.0325821370363611814);
    a[5][0]=ctype(-0.0343925157880443388,-0.0546153527101731633);
    a[5][1]=ctype(0.0802004793775135041,-0.0129207391006553752);
    a[5][2]=ctype(0.0097394100233448078,0.0387951467306087162);
    a[5][3]=ctype(-0.0688288374020057630,-0.0633639842179628914);
    a[5][4]=ctype(-0.0349736901160646840,-0.0254399348779464424);
    a[5][5]=ctype(0.847912814635651974,-0.028621321848165464);
    a[5][6]=ctype(0.1095578871733911507,-0.0474121790101010668);
    a[5][7]=ctype(0.0138760906775221576,-0.0094744843286703815);
    a[6][0]=ctype(0.0175906240591647928,0.0231084474029750880);
    a[6][1]=ctype(-0.050775989657952343,-0.162635498253732259);
    a[6][2]=ctype(0.0937035324811659806,0.0670130283698807230);
    a[6][3]=ctype(-0.172401255060844694,0.065052150015609992);
    a[6][4]=ctype(-0.023624969562281813,-0.159546217307420696);
    a[6][5]=ctype(-0.0308559220459904554,-0.0049471109542402547);
    a[6][6]=ctype(0.777524055941943964,0.107490783576433826);
    a[6][7]=ctype(0.0067246516212769063,0.0181725571972977531);
    a[7][0]=ctype(-0.0385070797122340096,0.0339228602354764565);
    a[7][1]=ctype(-0.0385666292018651716,-0.0769055176170643497);
    a[7][2]=ctype(0.0564873291181188669,0.1031520838485446556);
    a[7][3]=ctype(-0.1006437894375391283,0.0867652087944538019);
    a[7][4]=ctype(-0.0087811104835830628,-0.0165907480167805567);
    a[7][5]=ctype(0.0019235271319774004,0.0745075297425344328);
    a[7][6]=ctype(-0.1034757553334280386,0.0330861177435087888);
    a[7][7]=ctype(0.797615630848867829,-0.026439047155320367);


    cayley_hamilton<ctype> ch(n);


    ch(a,ea);
    std::cout<<"exp(a):"<<std::endl;
    for(int i=0; i<n; ++i) {
        for(int j=0; j<n; ++j) {
            std::cout<<ea[i][j]<<" ";
        }
        std::cout<<std::endl;
    }
    std::cout<<std::endl;


    for(int i=0; i<n; ++i) {
        delete[] a[i];
    }
    delete[] a;
    for(int i=0; i<n; ++i) {
        delete[] ea[i];
    }
    delete[] ea;
}
